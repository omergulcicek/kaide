---
description: "React: lifecycle, hooks, data flow. Stil/component → ui-components.mdc."
globs: "src/components/**/*.{ts,tsx},src/hooks/**/*.{ts,tsx}"
alwaysApply: false
---

# React (Lifecycle · Hooks · Data Flow)

**Ref:** Stil, atomik hiyerarşi, semantic HTML → `ui-components.mdc`. HTTP/data fetching yasağı → `api.mdc`. Hook ile veri → `tanstack-query.mdc`. Mimari → `docs/architecture-guide.md`, karar geçmişi → `docs/MEMORIES.md`.

---

## Kısıtlamalar (Constraints)

- **SRP:** Tek sorumluluk; 150+ satır → parçala.
- **Prop drilling (2+ seviye) yok:** children / slot / context.
- **Naming:** Component/file PascalCase; hook camelCase + `use`; index.tsx yerine explicit entry.
- **Memoization:** React 19+ / Compiler; manuel useMemo/useCallback azalt. Context Provider value + custom hook dönüş değeri referans kritikse manuel useMemo.
- **Custom hook:** Sadece business logic veya complex state; basit state component’te.
- **exhaustive-deps:** Açık; dependency array bilinçli.
- **setState:** Önceki state’e bağlı güncelleme → `setState(prev => ...)`.
- **useEffect + harici fn:** useEvent veya useCallback ile sarmala (stale closure önleme).
- **useEffect:** Last resort. Sync türev → useMemo. Kullanıcı/event → handler (onClick, onChange).
- **State:** Sadece en yakın ortak ataya kaldır. Karmaşık güncelleme → immer. Aynı veri birden fazla state’te yok. Global (theme, auth) → context/provider.
- **Derived:** Props → state eşitleme yok; derived value kullan.

---

## Yasaklar (Bans)

- Deep prop drilling (2+).
- Basit/local state’i hook’a taşımak.
- Dependency array’i bilerek eksik bırakmak.
- Sync’i effect’e, event’i effect’e taşımak.
- Props → state eşitleme.
- Doğrudan mutate.
- Aynı veriyi birden fazla state’te tutmak.
- Global concern’i prop ile taşımak.
- Bileşen içinde data fetching/HTTP (Ref: api.mdc).
- Büyük hesaplamayı render sırasında çalıştırmak.

---

## Always Do

```tsx
const stableOnSave = useEvent(onSave);
useEffect(() => { stableOnSave(data); }, [data]);
```

```tsx
setCount((prev) => prev + 1);
```

---

## Never Do

```tsx
useEffect(() => { onSave(data); }, [data]);
```

```tsx
useEffect(() => { fetchData(); }, []);
```
