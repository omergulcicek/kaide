---
description: "USE WHEN: Global state (Zustand) veya client state yönetiyorsan."
globs: "src/stores/**/*.ts,src/features/**/stores/**/*.ts"
alwaysApply: false
---

# State Management

## Constraints

- **Library:** Client state için `Zustand` kullan.
- **Scope:** Global `src/stores`, Feature `src/features/[feature]/stores`.
- **Selectors:** State'i her zaman selector ile tüket (`useStore(s => s.val)`).
- **SSR:** `useHydrated` ile client-side render'ı garanti et.
- **Persistence:** `persist` middleware kullanıyorsan `onRehydrateStorage` ayarla.
- **Server State:** TanStack Query kullan. Store'a koyma.

## Bans

- Store verisini prop ile geçmek.
- Yüksek frekanslı state'i (input) store'a koymak.
- Store içinde side-effect (API çağrısı).
- Init sırasında `window`/`localStorage` erişimi.
- Selector kullanmadan tüm store'u dönmek.

## Always Do

```ts
const user = useUserStore((s) => s.user);
const isHydrated = useHydrated();
```

## Never Do

```ts
const { user } = useUserStore(); // Selector yok
const store = create(() => ({ data: localStorage.getItem("x") })); // SSR hata
```
